# Data Warehousing

# Scenario
You are a data engineer hired by an ecommerce company named SoftCart.com . The company retails download only items like E-Books, Movies, Songs etc. The company has international presence and customers from all over the world. The company would like to create a data warehouse so that it can create reports like
 * total sales per year per country
 * total sales per month per category
 * total sales per quarter per country
 * total sales per category per country
You will use your data warehousing skills to design and implement a data warehouse for the company.

## Objectives
In this assignment you will:
 * Design a Data Warehouse using the pgAdmin ERD design tool.
 * Create the schema in the Data Warehouse

# Tools / Software
 * ERD Design Tool of pgAdmin
 * PostgreSQL Database Server

# Exercise 1 - Design a Data Warehouse
The ecommerce company has provied you the sample data.
![image](https://github.com/alihsan-tsdln/ibm-data-engineering-capstone/assets/91479565/24ddc300-9e3b-4466-a0e7-362af0f5e865)
You will start your project by designing a Star Schema for the warehouse by identifying the columns for the various dimension and fact tables in the schema. Name your database as softcart
<pre lang="sql">
CREATE DATABASE softcart;
</pre>
## Task 1 - Design the dimension table softcartDimDate
Using the ERD design tool design the table softcartDimDate. The company is looking at a granularity of a day. Which means they would like to have the ability to generate the report on yearly, monthly, daily, and weekday basis.

## Task 2 - Design the dimension table softcartDimCategory
Using the ERD design tool design the table softcartDimCategory.

## Task 3 - Design the dimension table softcartDimItem
Using the ERD design tool design the table softcartDimItem.

## Task 4 - Design the dimension table softcartDimCountry
Using the ERD design tool design the table softcartDimCountry.

## Task 5 - Design the fact table softcartFactSales
Using the ERD design tool design the table softcartFactSales.

## Task 6 - Design the relationships
Using the ERD design tool design the required relationships(one-to-one, one-to-many etc) amongst the tables.

# Exercise 2 - Create the schema
In this exercise you will create the schema of the data warehouse.
![Untitled (4)](https://github.com/alihsan-tsdln/ibm-data-engineering-capstone/assets/91479565/1d1c19c6-20d7-4b01-b262-3617152f9666)

## Task 7 - Create the schema.
Download the schema sql from ERD tool and create the schema in a database named staging.
<pre lang="sql">
-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE staging."softcartDimCategory"
(
    "categoryID" integer NOT NULL,
    category text,
    "isSocialActivity" boolean,
    "isActive" boolean,
    "parentCategory" boolean,
    "categoryLevel" smallint,
    PRIMARY KEY ("categoryID")
);

CREATE TABLE staging."softcartDimCountry"
(
    "countryID" integer NOT NULL,
    "countryName" text,
    continent text,
    region text,
    "EU" boolean,
    religion text,
    "isSeaside" boolean,
    "isOceanSide" boolean,
    PRIMARY KEY ("countryID")
);

CREATE TABLE staging."softcartDimDate"
(
    date date NOT NULL,
    day smallint,
    monthnumber smallint,
    monthname text,
    year smallint,
    "isWeekday" boolean,
    CONSTRAINT "generalDateCheck" CHECK (day > 0 AND day <= 31 AND monthnumber > 0 AND monthnumber <= 12) NOT VALID
    PRIMARY KEY (date)
);

CREATE TABLE staging."softcartDimItem"
(
    item_id integer NOT NULL,
    item_name text,
    average_rate real,
    sale_count bigint,
    rotten_tomatos_rate smallint,
    metacritic_rate smallint,
    CONSTRAINT "generalItemCheck" CHECK (average_rate > 0::double precision AND average_rate <= 5::double precision AND rotten_tomatos_rate <= 100 AND rotten_tomatos_rate > 0 AND metacritic_rate > 0 AND metacritic_rate <= 100) NOT VALID
    PRIMARY KEY (item_id)
);

CREATE TABLE staging."softcartFactSales"
(
    "orderID" integer NOT NULL,
    "itemID" integer,
    "categoryID" integer,
    price money,
    "countryID" integer,
    date date,
    PRIMARY KEY ("orderID")
);

ALTER TABLE staging."softcartFactSales"
    ADD FOREIGN KEY ("categoryID")
    REFERENCES staging."softcartDimCategory" ("categoryID")
    NOT VALID;


ALTER TABLE staging."softcartFactSales"
    ADD FOREIGN KEY ("countryID")
    REFERENCES staging."softcartDimCountry" ("countryID")
    NOT VALID;


ALTER TABLE staging."softcartFactSales"
    ADD FOREIGN KEY (date)
    REFERENCES staging."softcartDimDate" (date)
    NOT VALID;


ALTER TABLE staging."softcartFactSales"
    ADD FOREIGN KEY ("itemID")
    REFERENCES staging."softcartDimItem" (item_id)
    NOT VALID;

END;
</pre>









